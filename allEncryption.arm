// Build AES Key into x1 (128-bit) in big-endian style (MSB first)

//Add Together All of the Registers
// Funct7  rs2   rs1  funct3  rd   opcode
//XXXXXXX XXXXX XXXXX  XXX  XXXXX XXXXXXX
//ADD
//0000000 XXXXX XXXXX  000  XXXXX 0110011

//Generate RoundKeys
// Funct7  imm   rs1  funct3  rd   opcode
//XXXXXXX XXXXX XXXXX  XXX  XXXXX XXXXXXX
//keyExpandRound
//0000000 XXXXX XXXXX  001  XXXXX 1100011
//rs1=prior key

//RegRoundEnc
// Funct7  rk   state  funct3  rd   opcode
//XXXXXXX XXXXX XXXXX  XXX  XXXXX XXXXXXX
//0000000 XXXXX XXXXX  000  XXXXX 1100011

////////////////////////////////////////////////////////////////////////////
//////////////////////AES-128 ENCRYPTION KEY///////////////////////////////

//Encryption Key: 2b 7e 15 16 28 ae d2 a6 ab f7 15 88 09 cf 4f 3c
00101011011111111000000000010011 //X0 = X31 + 0x2B7 || ADDI
11100001010111111000000010010011 //X1 = X31 + 0xE15 || ADDI
00010110001011111000000100010011 //X2 = X31 + 0x162 || ADDI
10001010111011111000000110010011 //X3 = X31 + 0x8AE || ADDI
11010010101011111000001000010011 //X4 = X31 + 0xD2A || ADDI
01101010101111111000001010010011 //X5 = X31 + 0x6AB || ADDI
11110111000111111000001100010011 //X6 = X31 + 0xF71 || ADDI
01011000100011111000001110010011 //X7 = X31 + 0x588 || ADDI
00001001110011111000010000010011 //X8 = X31 + 0x09C || ADDI
11110100111111111000010010010011 //X9 = X31 + 0xF4F || ADDI
00000011110011111000010100010011 //X10 = X31 + 0x03C|| ADDI
00000111010011111000010110010011 //X11 = X31 + 116  || ADDI
00000000101100000100000000110011 //X0 = X0 << X11   || SLL
00000110100011111000010110010011 //X11 = X31 + 104  || ADDI
00000000101100001100000010110011 //X1 = X1 << X11   || SLL
00000101110011111000010110010011 //X11 = X31 + 92   || ADDI
00000000101100010100000100110011 //X2 = X2 << X11   || SLL
00000101000011111000010110010011 //X11 = X31 + 80   || ADDI
00000000101100011100000110110011 //X3 = X3 << X11   || SLL
00000100010011111000010110010011 //X11 = X31 + 68   || ADDI
00000000101100100100001000110011 //X4 = X4 << X11   || SLL
00000011100011111000010110010011 //X11 = X31 + 56   || ADDI
00000000101100101100001010110011 //X5 = X5 << X11   || SLL
00000010110011111000010110010011 //X11 = X31 + 44   || ADDI
00000000101100110100001100110011 //X6 = X6 << X11   || SLL
00000010000011111000010110010011 //X11 = X31 + 32   || ADDI
00000000101100111100001110110011 //X7 = X7 << X11   || SLL
00000001010011111000010110010011 //X11 = X31 + 20   || ADDI
00000000101101000100010000110011 //X8 = X8 << X11   || SLL
00000000100011111000010110010011 //X11 = X31 + 8    || ADDI
00000000101101001100010010110011 //X9 = X9 << X11   || SLL

00000000000000001000011000110011 //X12 = X0 + X1   || ADD
00000000110000010000011000110011 //X12 = X12 + X2  || ADD
00000000110000011000011000110011 //X12 = X12 + X3  || ADD
00000000110000100000011000110011 //X12 = X12 + X4  || ADD
00000000110000101000011000110011 //X12 = X12 + X5  || ADD
00000000110000110000011000110011 //X12 = X12 + X6  || ADD
00000000110000111000011000110011 //X12 = X12 + X7  || ADD
00000000110001000000011000110011 //X12 = X12 + X8  || ADD
00000000110001001000011000110011 //X12 = X12 + X9  || ADD
00000000110001010000011000110011 //X12 = X12 + X10 || ADD

////////////////////////////////////////////////////////////////////////////
//////////////////////GENERATE PLAINTEXT///////////////////////////////////

//Generate Plaintext : 324 3f6 a88 85a 308 d31 319 8a2 e03 707 34
00110010010011111000000000010011 //X0 = X31 + 0x324 || ADDI
00111111011011111000000010010011 //X1 = X31 + 0x3F6 || ADDI
10101000100011111000000100010011 //X2 = X31 + 0xA88 || ADDI
10000101101011111000000110010011 //X3 = X31 + 0x85A || ADDI
00110000100011111000001000010011 //X4 = X31 + 0x308 || ADDI
11010011000111111000001010010011 //X5 = X31 + 0xD31 || ADDI
00110001100111111000001100010011 //X6 = X31 + 0x319 || ADDI
10001010001011111000001110010011 //X7 = X31 + 0x8A2 || ADDI
11100000001111111000010000010011 //X8 = X31 + 0xE03 || ADDI
01110000011111111000010010010011 //X9 = X31 + 0x707 || ADDI
00000011010011111000010100010011 //X10 = X31 + 0x034|| ADDI
00000111010011111000010110010011 //X11 = X31 + 116  || ADDI
00000000101100000100000000110011 //X0 = X0 << X11   || SLL
00000110100011111000010110010011 //X11 = X31 + 104  || ADDI
00000000101100001100000010110011 //X1 = X1 << X11   || SLL
00000101110011111000010110010011 //X11 = X31 + 92   || ADDI
00000000101100010100000100110011 //X2 = X2 << X11   || SLL
00000101000011111000010110010011 //X11 = X31 + 80   || ADDI
00000000101100011100000110110011 //X3 = X3 << X11   || SLL
00000100010011111000010110010011 //X11 = X31 + 68   || ADDI
00000000101100100100001000110011 //X4 = X4 << X11   || SLL
00000011100011111000010110010011 //X11 = X31 + 56   || ADDI
00000000101100101100001010110011 //X5 = X5 << X11   || SLL
00000010110011111000010110010011 //X11 = X31 + 44   || ADDI
00000000101100110100001100110011 //X6 = X6 << X11   || SLL
00000010000011111000010110010011 //X11 = X31 + 32   || ADDI
00000000101100111100001110110011 //X7 = X7 << X11   || SLL
00000001010011111000010110010011 //X11 = X31 + 20   || ADDI
00000000101101000100010000110011 //X8 = X8 << X11   || SLL
00000000100011111000010110010011 //X11 = X31 + 8    || ADDI
00000000101101001100010010110011 //X9 = X9 << X11   || SLL

00000000000000001000011010110011 //X13 = X0 + X1   || ADD
00000000110100010000011010110011 //X13 = X13 + X2  || ADD
00000000110100011000011010110011 //X13 = X13 + X3  || ADD
00000000110100100000011010110011 //X13 = X13 + X4  || ADD
00000000110100101000011010110011 //X13 = X13 + X5  || ADD
00000000110100110000011010110011 //X13 = X13 + X6  || ADD
00000000110100111000011010110011 //X13 = X13 + X7  || ADD
00000000110101000000011010110011 //X13 = X13 + X8  || ADD
00000000110101001000011010110011 //X13 = X13 + X9  || ADD
00000000110101010000011010110011 //X13 = X13 + X10 || ADD

////////////////////////////////////////////////////////////////////////////
//////////////////////AES-128 ROUNDKEYS////////////////////////////////////

00000000000001100001000001100011 //X0 = round key 1
00000000000100000001000011100011 //X1 = round key 2
00000000001000001001000101100011 //X2 = round key 3
00000000001100010001000111100011 //X3 = round key 4
00000000010000011001001001100011 //X4 = round key 5
00000000010100100001001011100011 //X5 = round key 6
00000000011000101001001101100011 //X6 = round key 7
00000000011100110001001111100011 //X7 = round key 8
00000000100000111001010001100011 //X8 = round key 9
00000000100101000001010011100011 //X9 = round key 10

////////////////////////////////////////////////////////////////////////////
//////////////////////AES-128 DECRYPTION///////////////////////////////////

//Initial XOR
00000000110001101001011100110011 // X14 = X12 ^ X13 || XOR

//Begin Encryption
//Cipher Text : 39 25 84 1D 02 DC 09 FB DC 11 85 97 19 6A 0B 32
00000000000001110000011111100011 // X15 = X14 ^ X0 || regRoundEnc
00000000000101111000011111100011 // X15 = X15 ^ X1 || regRoundEnc
00000000001001111000011111100011 // X15 = X15 ^ X2 || regRoundEnc
00000000001101111000011111100011 // X15 = X15 ^ X3 || regRoundEnc
00000000010001111000011111100011 // X15 = X15 ^ X4 || regRoundEnc
00000000010101111000011111100011 // X15 = X15 ^ X5 || regRoundEnc
00000000011001111000011111100011 // X15 = X15 ^ X6 || regRoundEnc
00000000011101111000011111100011 // X15 = X15 ^ X7 || regRoundEnc
00000000100001111000011111100011 // X15 = X15 ^ X8 || regRoundEnc
00000100100101111000011111100011 // X15 = X15 ^ X9 || finalRoundEnc

////////////////////////////////////////////////////////////////////////////
//////////////////////AES-128 DECRYPTION///////////////////////////////////
//////////////////////////////////////////////////////////////////////////

//Initial Decryption XOR
00000000100101111001011100110011 // X14 = X9 ^ X15

//Plaintext : 32 43 f6 a8 88 5a 30 8d 31 31 98 a2 e0 37 07 34
00000000100001110010011101100011 // X14 = X14 ^ X8 || regRoundDec
00000000011101110010011101100011 // X14 = X14 ^ X7 || regRoundDec
00000000011001110010011101100011 // X14 = X14 ^ X6 || regRoundDec
00000000010101110010011101100011 // X14 = X14 ^ X5 || regRoundDec
00000000010001110010011101100011 // X14 = X14 ^ X4 || regRoundDec
00000000001101110010011101100011 // X14 = X14 ^ X3 || regRoundDec
00000000001001110010011101100011 // X14 = X14 ^ X2 || regRoundDec
00000000000101110010011101100011 // X14 = X14 ^ X1 || regRoundDec
00000000000001110010011101100011 // X14 = X14 ^ X0 || regRoundDec
00000100110001110010011101100011 // X14 = X14 ^ X12|| finalRoundDec

////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////


////////////////////////////////////////////////////////////////////////////
//////////////////////SHA-512/256 Encryption///////////////////////////////
//////////////////////////////////////////////////////////////////////////

//Preprocess the Data
//X0 = X0 << 12    || slli
//X0 = X0 + X1     || ADD
//X1 = X31 + 1     || ADDI
//X1 = X31 << (128-24) || slli
//X0 = X0 + X1     || ADD
//Zero out X1-X14  || X? = X31 + X31
//X15 = length of input message
011000010110_11111_000_00000_0010011 //X0 = X31 + 0x616 || ADDI
001001100011_11111_000_00001_0010011 //X1 = X31 + 0x263 || ADDI
000000110100_00000_100_00000_0010011 //X0 = X0 << 52    || SLLI
000000101000_00001_100_00001_0010011 //X1 = X1 << 40    || SLLI
0000000_00000_00001_000_00000_0110011 //X0 = X0 + X1    || ADD
000000000001_11111_000_00001_0010011 //X1 = X31 + 0x1   || ADDI
000000100111_00001_100_00001_0010011 //X1 = X1 << 39    || SLLI
0000000_00000_00001_000_00000_0110011 //X0 = X0 + X1    || ADD

//Perform msgRounds
//WORD_MEM = X0 || MSG_ROUND

//XX00010_11111_00000_000_11111_1101111 //wordMem[round] = X0[63:0]
000000001110_11111_000_00010_0010011    //ADDI X2 X31 #14
0000000_11111_11111_000_00001_0110011   //ADD X1 X31 X31 || X1=i=0
//Loop code starts here
00_00001_11111_00000_000_11111_1101111  //MSG_ROUND X31 X0 X31 X1
000000000001_00001_000_00001_0010011    //ADD X1 X1 #1 || X1 += 1
00_00001_11111_11111_000_11111_1101111  //MSG_ROUND X31 X31 X31 X1
000000000001_00001_000_00001_0010011    //ADDI X1 X1 #1 || X1 += 1
1111111_00010_00001_011_1111_1_1100011  //B.LE X1 X2 || X1 < X2

000000011000_11111_000_00011_0010011    //ADDI X3 X31 #0x18
00_00001_11111_00011_000_11111_1101111  //MSG_ROUND X31 X3 X31 X1
000000000001_00001_000_00001_0010011    //ADDI X1 X1 #1 || X1 += 1

//Rounds 16-79
000001001111_11111_000_00010_0010011    //ADDI X2 X31 #79
00_00001_11111_11111_000_11111_1101111  //MSG_ROUND X31 X31 X31 X1
000000000001_00001_000_00001_0010011    //ADDI X1 X1 #1
1111111_00010_00001_011_1111_1_1100011  //B.LE X1 X2 || X1 < X2

//Loop 80 times through T1, T2 then recombine

//Set initial hashes using registers X0-X3
0000000_11111_11111_000_00100_0110011   //ADD X4 X31 X31
00_00100_11111_11111_100_00000_1101111  //SETHASH X0 X4
000000000001_00100_000_00100_0010011    //ADDI X4 X4 #1
00_00100_11111_11111_100_00001_1101111  //SETHASH X1 X4
000000000001_00100_000_00100_0010011    //ADDI X4 X4 #1
00_00100_11111_11111_100_00010_1101111  //SETHASH X2 X4
000000000001_00100_000_00100_0010011    //ADDI X4 X4 #1
00_00100_11111_11111_100_00011_1101111  //SETHASH X3 X4

//Set loop variables X6 (i) and X7 (iterative limit)
//A&B = X0
//C&D = X1
//E&F = X2
//G&H = X3
0000000_11111_11111_000_00111_0110011   //ADD X7 X31 X31
000001001111_11111_000_01000_0010011    //ADDI X8 X31 #79
00_00111_00011_00010_001_00100_1101111  //T1 X4 X2 X3 X7
00_00111_00001_00000_010_00101_1101111  //T2 X5 X0 X1 X7
00_11111_00011_00010_011_00011_1101111  //ADDHASH X3 X2 X3 X31
01_00100_00010_00001_011_00010_1101111  //ADDHASH X2 X2 X1 X4
00_11111_00001_00000_011_00001_1101111  //ADDHASH X1 X0 X1 X31
10_00101_00100_00000_011_00000_1101111  //ADDHASH X0 X0 X4 X5
000000000001_00111_000_00111_0010011    //ADDI X7 X7 #1
0000000_11111_11111_000_11111_0110011   //ADD X31 X31 X31
1111111_01000_00111_011_1100_1_1100011  //B.LE X7 X8 || X7 < X8

00_11111_11111_00000_101_00000_1101111  //FINALHASH X0 X0 || Top 128 Bits
01_11111_11111_00001_101_00001_1101111  //FINALHASH X1 X1 || Bottom 128 Bits